{% extends 'aboutuspagecontent.html'%}
{% load static %}
{% get_static_prefix as dir %}
{% block content %}
<style>
  body {
    font-family: Arial, sans-serif;

    margin: 0;
    padding: 0;
  }
  #drop-area {
    border: 2px dashed #ccc;
    border-radius: 8px;
    padding: 20px;
    cursor: pointer;
  }
  #image-list {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }
  .image-preview {
    margin: 10px;
    display: inline-block;
    text-align: center;
  }
  .image-preview img {
    max-width: 100px;
    max-height: 100px;
  }
  .drag-drop-icon {
      font-size: 58px;
      text-align: center; /* Adjust the size as needed */
    }
    .dropdown-item {
      display: flex;
      align-items: center;
      margin: 5px;
    }

    input[type="radio"] {
      margin-right: 10px;
    }</style>
<!-- End Sidebar Modal -->

                <div class="dashboard-innerbox">
                            <div class="inner-page-sec">
                              <div class="description-sec">
                                <h2>Update Product </h2>
                                <div class="row">
                                    {% if messages %}
                                    {% for message in messages %}
                                      {% if message.tags == 'success' %}
                                        <div class="alert alert-success" role="alert">
                                          {{ message }}
                                        </div>
                                      {% elif message.tags == 'error' %}
                                        <div class="alert alert-danger" role="alert">
                                          {{ message }}
                                        </div>
                                      {% endif %}
                                    {% endfor %}
                                  {% endif %}
                                    <div class="col-lg-12 col-md-12">
                                        <div class="inner-card">
                                            <div class="inner-card-body">
                                                <div class="product-info">
                                            
                                                  
                                                    <form id="my-form"method="post" enctype="multipart/form-data" action="{% url 'update_product' slug=product.slug %}">
                                                      {% csrf_token %}
                                                        <div class="product-group">
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Sub-Category:</label>
                                                                <select class="form-control" id="subcategory" required name="subcategory">
                                                                    <option value="">{{ product.subcategory }}</option>
                                                                    {% for subcategory in subcategories %}
                                                                    {% if subcategory.category.is_active %}
                                                                        <option value="{{ subcategory.id }}" {% if product.subcategory == subcategory %}selected{% endif %}>
                                                                            {{ subcategory.name }}
                                                                        </option>
                                                                    {% endif %}
                                                                {% endfor %}
                                                                  </select>
                                                              </div>
                                                            </div>
                                                          </div>
                                                         
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Title:</label>
                                                                <input type="text" class="form-control" required id="product-title" name="title" value="{{product.title}}">
                                                              </div>
                                                            </div>
                                                          </div>

                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Model:</label>
                                                                <input type="text" class="form-control" id="product-model" name="model_name" value="{{product.model_name}}">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Watts:</label>
                                                                <input type="text" class="form-control" id="watts" name="watts" value="{{product.watts}}">
                                                              </div>
                                                            </div>
                                                          </div>

                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">CCT:</label>
                                                                <input type="text" class="form-control" id="cct" name="cct" value="{{product.cct}}">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Dimmable System:</label>
                                                                <input type="text" class="form-control" id="dimmable-system" name="dimmable_system" value="{{product.dimmable_system}}">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Lumen Efficiency:</label>
                                                                <input type="text" class="form-control" id="lumen-efficiency" name="lumen_efficiency" value="{{product.lumen_efficiency}}">
                                                            </div>
                                                              </div>
                                                            </div>
                            
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Fixing:</label>
                                                                <input type="text" class="form-control" id="Fixing" name="fixing" value="{{product.fixing}}">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">LED Source:</label>
                                                                <input type="text" class="form-control" id="led-source" name="led_source" value="{{product.led_source}}">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">IP Rating:</label>
                                                                <input type="text" class="form-control" id="ip-rating" name="ip_rating" value="{{product.ip_rating}}">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Life Span:</label>
                                                                <input type="text" class="form-control" id="life-span" name="life_span" value="{{product.life_span}}">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Description:</label>
                                                                <textarea class="form-control" rows="6" id="product-description" name="product_description">{{product.product_description}}</textarea>
                                                              </div>
                                                            </div>
                                                          </div>

                                                          <div class="row">
                                                            <div class="col-sm-12">
                                                                <div class="mb-3">
                                                                    <label class="form-label">Product Main Carousel Image:</label><br>
                                                                    <p class="text-warning">Please use images with the same resolution (in pixels) to achieve a visually appealing carousel view.</p>
                                                                    <div id="drop-area">
                                                                        <p class="text-center">Drag and drop images here or click to select</p>
                                                                        <div class="drag-drop-icon">
                                                                            <i class="bx bx-cloud-upload"></i>
                                                                        </div>
                                                                        <input type="file" id="image-input" name="image1[]" accept="image/*" multiple style="display: none;">
                                                                    </div>
                                                                    <div class="mt-3 mb-3">
                                                                      <p>Selected Images: <span class="text-warning">During the process of updating the images, please select a picture to update your display image as well</span></p>
                                                                      
                                                                      <div id="selected-images-list">
                                                                          {% for image in product.image1.all %}
                                                                              <img src="{{ image.file.url }}" alt="{{ image.file.name }}" width="50" height="50" class="mx-3">
                                                                          {% endfor %}
                                                                      </div>
                                                                  </div>
                                                                  <div id="error-message" class="text-danger"></div>
                                                                    <input type="hidden" id="selected-image-url" name="selected-image-filename">
                                                                </div>
                                                            </div>
                                                        </div>

                                                      <!--   <div class="row">
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Main Carousel Image:</label><br>
                                                                <p class="text-warning">Please use images with the same resolution (in pixels) to achieve a visually appealing carousel view.</p>
                                                               
                                                                <input type="file" id="image-input" name="image1[]" class="form-control" multiple>
                                                                <div id="selected-images" class="dropdown mt-3 mb-3">
                                                                  <button class="btn btn-secondary dropdown-toggle" type="button" id="selected-images-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                    Selected Images
                                                                  </button>
                                                                  <div class="dropdown-menu" aria-labelledby="selected-images-dropdown">
                                                                    <div id="selected-images-list">
                                                                      {% for image in product.image1.all %}
                                                                        <p class="mx-3">{{ image.file.name }}</p>
                                                                      {% endfor %}
                                                                    </div>
                                                              </div>
                                                            </div>
                                                       <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Display Picture: </label><br>
                                                                <p class="text-warning">Please use JPEG format for maximum compression, and ensure image dimensions are above 500 pixels for better clarity.</p>
                                                                <input type="file" class="form-control form-control-file" id="displayimage1" name="displayimage1" >
                                                                <p >Currently chosen File: <span class="text-info">{{ product.displayimage1 }}</span></p>
                                                              </div>
                                                            </div>
                                                          </div>
  <!-- 
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Display Image 2:</label><br>
                                                                <input type="file" class="form-control form-control-file" id="displayimage2" name="displayimage2" >
                        <p >Currently chosen File: <span class="text-info">{{ product.displayimage2 }}</span></p>
                                                              </div>
                                                            </div>
                                                          </div>

                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Display Image 3:</label><br>
                                                                <input type="file" class="form-control form-control-file" id="displayimage3" name="displayimage3" >
                                                                <p >Currently chosen File: <span class="text-info">{{ product.displayimage3 }}</span></p>
                                                              </div>
                                                            </div>
                                                          </div>-->
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Data Sheet:</label><br>
                                                                <input type="file" class="form-control form-control-file" id="data_sheet" name="data_sheet" accept=".pdf" >
                                                                <p >Currently chosen File: <span class="text-info">{{ product.data_sheet }}</span></p>
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">LDT file:</label><br>
                                                                <input type="file" class="form-control form-control-file" id="ldf_file" name="ldf_file" accept=".ldf" >
                                                                <p >Currently chosen File: <span class="text-info">{{ product.ldf_file }}</span></p>
                                                              </div>
                                                            </div>
                                                          </div>
                                                          
                                                          <div class="row">
                                                            <div class="col-sm-12 text-end">
                                                                <button class="btn btn-secondary mx-3" type="submit" >Update</a>
                                                            </div></div>
                                                        </div>
                                                      </form>
   </div></div></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row bg-row">
                                      <div class="col-md-5 col-lg-5 pocket-help">
                                          <h2>Ask pocket Friendly for Help 24/7</h2>
                                          <h6>Get In Touch : </h6>
                                        
                                          <div class="number-block"> <a href="tel:+ +971 585893348"> +971585893348 </a>  
                                             </div>
                                          </div>
                                  </div>
                                  </div>
                            
                
                     
                </div>
                </div>
        </div>
      </section>
                                  

 <!-- Repeat the above code for each additional collapsed navbar, changing the data-target and form content as needed. -->
  <!-- jQuery library -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>

  <!-- Popper JS -->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  
  <!-- Latest compiled JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
 const dropArea = document.getElementById('drop-area');
const fileInput = document.getElementById('image-input');
const selectedImagesList = document.getElementById('selected-images-list');
const selectedImageUrlField = document.getElementById('selected-image-url');
const form = document.getElementById('my-form');
const errorMessage = document.getElementById('error-message');

dropArea.addEventListener('dragover', handleDragOver);
dropArea.addEventListener('drop', handleDrop);
dropArea.addEventListener('click', handleClick);
fileInput.addEventListener('change', handleFileSelect);


function handleDragOver(event) {
    event.preventDefault();
    dropArea.classList.add('drag-over');
}

function handleDrop(event) {
    event.preventDefault();
    dropArea.classList.remove('drag-over');
    const files = event.dataTransfer.files;
    displaySelectedImages(files);
}

function handleClick() {
    fileInput.click();
}

function handleFileSelect(event) {
    const files = event.target.files;
    displaySelectedImages(files);
}

function displaySelectedImages(files) {
    selectedImagesList.innerHTML = '';

    for (let i = 0; i < files.length; i++) {
        const file = files[i];
        const listItem = document.createElement('div');
        listItem.classList.add('dropdown-item');

        const radioButton = document.createElement('input');
        radioButton.type = 'radio';
        radioButton.name = 'selected-product';
        radioButton.value = file.name;

        const image = document.createElement('img');
        image.src = URL.createObjectURL(file);
        image.width = 50;
        image.height = 50;

        listItem.appendChild(radioButton);
        listItem.appendChild(image);

        selectedImagesList.appendChild(listItem);
    }

    const radioButtons = document.querySelectorAll('input[name="selected-product"]');
    radioButtons.forEach(radioButton => {
        radioButton.addEventListener('click', function() {
            selectedImageUrlField.value = radioButton.value;
        });
    });
}

  </script>
{% endblock %}