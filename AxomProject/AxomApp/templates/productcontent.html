{% extends 'aboutuspagecontent.html'%}
{% load static %}
{% get_static_prefix as dir %}
{% block content %}
<!-- End Sidebar Modal -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@2.0.9/css/boxicons.min.css">

<style>
  body {
    font-family: Arial, sans-serif;

    margin: 0;
    padding: 0;
  }
  #drop-area {
    border: 2px dashed #ccc;
    border-radius: 8px;
    padding: 20px;
    cursor: pointer;
  }
  #image-list {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }
  .image-preview {
    margin: 10px;
    display: inline-block;
    text-align: center;
  }
  .image-preview img {
    max-width: 100px;
    max-height: 100px;
  }
  .drag-drop-icon {
      font-size: 58px;
      text-align: center; /* Adjust the size as needed */
    }
    .dropdown-item {
      display: flex;
      align-items: center;
      margin: 5px;
    }

    input[type="radio"] {
      margin-right: 10px;
    }
</style>
                <div class="dashboard-innerbox">
                            <div class="inner-page-sec">
                              <div class="description-sec">
                                <h2>Add Product </h2>
                                <div class="row">
                                    {% if messages %}
                                    {% for message in messages %}
                                      {% if message.tags == 'success' %}
                                        <div class="alert alert-success" role="alert">
                                          {{ message }}
                                        </div>
                                      {% elif message.tags == 'error' %}
                                        <div class="alert alert-danger" role="alert">
                                          {{ message }}
                                        </div>
                                      {% endif %}
                                    {% endfor %}
                                  {% endif %}
                                    <div class="col-lg-12 col-md-12">
                                        <div class="inner-card">
                                            <div class="inner-card-body">
                                                <div class="product-info">
                                                    <h5>Add a new product</h5>
                                                  
                                                    <form id="my-form"method="post" enctype="multipart/form-data" action="{% url 'product_page' %}">
                                                      {% csrf_token %}
                                                        <div class="product-group">
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Category:</label>
                                                                <select class="form-control" id="subcategory" required name="subcategory">
                                                                    <option value="">Select</option>
                                                                    {% for subcategory in subcategories %}
                                                                    {% if subcategory.category.is_active %}
                                                                    <option value="{{ subcategory.id }}">{{ subcategory.name }}</option>
                                                                    {% endif %}
                                                                    {% endfor %}
                                                                  </select>
                                                              </div>
                                                            </div>
                                                          </div>
                                                         
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Title:</label>
                                                                <input type="text" required class="form-control" id="product-title" name="title">
                                                              </div>
                                                            </div>
                                                          </div>

                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Model:</label>
                                                                <input type="text" class="form-control" id="product-model" name="model_name">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Watts:</label>
                                                                <input type="text" class="form-control" id="watts" name="watts">
                                                              </div>
                                                            </div>
                                                          </div>

                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">CCT:</label>
                                                                <input type="text" class="form-control" id="cct" name="cct">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Dimmable System:</label>
                                                                <input type="text" class="form-control" id="dimmable-system" name="dimmable_system">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Lumen Efficiency:</label>
                                                                <input type="text" class="form-control" id="lumen-efficiency" name="lumen_efficiency">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Fixing:</label>
                                                                <input type="text" class="form-control" id="fixing" name="fixing">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">LED Source:</label>
                                                                <input type="text" class="form-control" id="led-source" name="led_source">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">IP Rating:</label>
                                                                <input type="text" class="form-control" id="ip-rating" name="ip_rating">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Life Span:</label>
                                                                <input type="text" class="form-control" id="life-span" name="life_span">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Product Description:</label>
                                                                <textarea class="form-control" id="product-description" rows="6" name="product_description"></textarea>
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row">
                                                            <div class="col-sm-12">
                                                                <div class="mb-3">
                                                                    <label class="form-label">Product Main Carousel Image:</label><br>
                                                                    <p class="text-warning">Please use images with the same resolution (in pixels) to achieve a visually appealing carousel view.</p>
                                                                    <div id="drop-area">
                                                                        <p class="text-center">Drag and drop images here or click to select</p>
                                                                        <div class="drag-drop-icon">
                                                                            <i class="bx bx-cloud-upload"></i>
                                                                        </div>
                                                                        <input type="file" id="image-input" name="image1[]" accept="image/*" multiple style="display: none;">
                                                                    </div>
                                                                    <div class="mt-3 mb-3">
                                                                      <p>Selected Images: <span class="text-warning">Select an image for your display picture.</span></p>
                                                                      <div id="selected-images-list"></div>
                                                                  </div>
                                                                  <div id="error-message" class="text-danger"></div>
                                                                    <input type="hidden" id="selected-image-url" name="selected-image-filename">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Display Picture: </label><br>
                                                                <p class="text-warning">Please use JPEG format for maximum compression, and ensure image dimensions are above 500 pixels for better clarity.</p>
                                                                <input type="file" class="form-control form-control-file" id="displayimage1" name="displayimage1" multiple>
                                                              </div>
                                                            </div>
                                                          </div> --> 
<!--
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Display Image 2:</label><br>
                                                                <input type="file" class="form-control form-control-file" id="displayimage2" name="displayimage2" multiple>
                                                              </div>
                                                            </div>
                                                          </div>

                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Display Image 3:</label><br>
                                                                <input type="file" class="form-control form-control-file" id="displayimage3" name="displayimage3" multiple>
                                                              </div>
                                                            </div>
                                                          </div>-->
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">Data Sheet:</label><br>
                                                                <input type="file" class="form-control form-control-file" id="data-sheet" name="data_sheet" accept=".pdf">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          <div class="row"> 
                                                            <div class="col-sm-12">
                                                              <div class="mb-3">
                                                                <label class="form-label">LDT file:</label><br>
                                                                <input type="file" class="form-control form-control-file" id="data-sheet" name="ldf_file" accept=".ldt">
                                                              </div>
                                                            </div>
                                                          </div>
                                                          
                                                          <div class="row">
                                                            <div class="col-sm-12 text-end">
                                                                <button class="btn btn-secondary mx-3" type="submit" >Add</button>
                                                            </div></div>
                                                        </div>
                                                      </form>

                                                </div>
                                            </div>
                                        </div> 
                                    </div>
                                    

                                </div>
                            </div>
                           
                                <div class="row bg-row">
                                    <div class="col-md-5 col-lg-5 pocket-help">
                                        <h2>Ask pocket Friendly for Help 24/7</h2>
                                        <h6>Get In Touch : </h6>
                                      
                                        <div class="number-block"> <a href="tel:+ +971 585893348"> +971585893348 </a>  
                                           </div>
                                        </div>
                                </div>
                                </div>
                          
              
                   
              </div>
              </div>
			</div>
		</section>
		<!-- End Sign In Area -->
        
<!-- JavaScript code -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const dropArea = document.getElementById('drop-area');
  const fileInput = document.getElementById('image-input');
  const selectedImagesList = document.getElementById('selected-images-list');
  const selectedImageUrlField = document.getElementById('selected-image-url');

  dropArea.addEventListener('dragover', handleDragOver);
  dropArea.addEventListener('drop', handleDrop);
  dropArea.addEventListener('click', handleClick);
  fileInput.addEventListener('change', handleFileSelect);
  const radioButtons = document.querySelectorAll('input[name="selected-product"]');
   radioButtons.forEach(radioButton => {
    radioButton.addEventListener('click', function() {
        selectedImageUrlField.value = radioButton.value;

        // Show the "Selected Images" div
        const selectedImagesDiv = document.getElementById('selected-images-list');
        selectedImagesDiv.style.display = 'block';
        
        // Display the selected image using the radioButton's parent node (listItem)
        const selectedImage = radioButton.parentNode.querySelector('img');
        const selectedImageCopy = selectedImage.cloneNode(true);
        selectedImagesDiv.appendChild(selectedImageCopy);
    });
});

  function handleDragOver(event) {
      event.preventDefault();
      dropArea.classList.add('drag-over');
  }

  function handleDrop(event) {
      event.preventDefault();
      dropArea.classList.remove('drag-over');
      const files = event.dataTransfer.files;
      displaySelectedImages(files);
  }

  function handleClick() {
      fileInput.click();
  }

  function handleFileSelect(event) {
      const files = event.target.files;
      displaySelectedImages(files);
  }

  function displaySelectedImages(files) {
    selectedImagesList.innerHTML = '';

    for (let i = 0; i < files.length; i++) {
      const file = files[i];
      const listItem = document.createElement('div');
      listItem.classList.add('dropdown-item');

      const radioButton = document.createElement('input');
      radioButton.type = 'radio';
      radioButton.name = 'selected-product';
      radioButton.value = file.name;

      const image = document.createElement('img');
      image.src = URL.createObjectURL(file);
      image.width = 50;
      image.height = 50;

      listItem.appendChild(radioButton);
      listItem.appendChild(image);

      selectedImagesList.appendChild(listItem);
    }

    const radioButtons = document.querySelectorAll('input[name="selected-product"]');
    radioButtons.forEach(radioButton => {
      radioButton.addEventListener('click', function() {
        selectedImageUrlField.value = radioButton.value;
      });
    });
  }
   
  const form = document.getElementById('my-form');
const errorMessage = document.getElementById('error-message');

form.addEventListener('submit', function (event) {
    const selectedImageUrl = selectedImageUrlField.value;

    if (!selectedImageUrl) {
        errorMessage.textContent = 'Please select an image for your display picture.';
        event.preventDefault(); // Prevent form submission
    } else {
        errorMessage.textContent = ''; // Clear error message
    }
});

</script>


{% endblock %}